<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="../stylesheets/config.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
    crossorigin="anonymous"></script>

  <title>Crear publicación</title>
</head>

<body>
  <div class="header">
    <img src="./index/falg.png" style=" margin-left: auto;margin-right: auto;">
  </div>
  <style>
    .header {
      text-align: center;
      background: #0e0c0c;
      font-size: 30px;
    }
  </style>
  <style>
    body {
      background-color: rgb(36, 36, 36);
      height: 500px;
    }
  </style>

  <nav id="menuarriba" class="navbar navbar-expand-lg navbar-dark bg-dark">
    <a class="navbar-brand" href="#">FALG</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item active">
          <a class="nav-link" href="./index.html" style="color: white;">Inicio <span
              class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./foro.html" style="color: white;">Foro</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./estadisticas.html" style="color: white;">Estadísticas</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="descarga.html" style="color: white;">Descarga</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false" style="color: white;">
            Ayuda
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="./soporte.html">Soporte</a>
            <a class="dropdown-item" href="./formulario.html">Generar reporte</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="./faq.html">FAQ</a>
          </div>
        </li>
        <li class="nav-item" style="padding-left: 485px;padding-top: 2px;">
          <a class="btn btn-secundary" style="background-color: #666666;color: white;" href="./ingreso.html"
            role="Ingresar">Ingresar</a>
        </li>
      </ul>
      <form class="form-inline my-2 my-lg-0">
        <input class="form-control mr-sm-2" type="search" placeholder="Buscar jugador/partida" aria-label="Search">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Buscar</button>
      </form>
    </div>
  </nav>


  <div style="padding-left: 600px;padding-top: 20px;width: 1300px;color: white;">
    <div style="text-align: center;">
      <h1>Crear publicación</h1>
    </div>
    <form class="was-validated" id="crearpublicacion">
      <div class="col-md-6 mb-3" style="padding-left: 0px;">
        <label for="validationServer01">Título</label>
        <input type="text" class="form-control is-valid" id="titulo" placeholder="Debe contener entre 4 y 20 caracteres"
          required style="width: 700px;">
        <div class="valid-feedback">
          Título valido
        </div>
      </div>
      <div class="mb-3">
        <label for="validationTextarea">Descripción</label>
        <textarea class="form-control is-invalid" id="descripcion"
          placeholder="Debe contener entre 10 y 1000 caracteres" style="height: 300px;"></textarea>
      </div>
      <div class="row">
        <div class="col-sm">
          <div class="mb-3">
            <h6>Elige el tipo de filtro</h6>
            <select class="custom-select">
              <option value="">Filtro...</option>
              <option value="1">Build</option>
              <option value="2">Guía</option>
              <option value="3">Lore</option>
            </select>
            <div class="invalid-feedback">Filtro obligatorio</div>
          </div>
        </div>
        <div class="col-sm">
          <h6>Escoge una imagen</h6>
          <div class="custom-file">
            <input type="file" class="custom-file-input" id="customFileLang" lang="es">
            <label class="custom-file-label" for="customFileLang">Seleccionar Archivo</label>
          </div>
        </div>
      </div>
      <div style="text-align: center;">
        <button type="submit" class="btn btn-secundary"
          style="background-color: #666666;color: white;width: 200px;height: 50px;" role="publicar">Subir
          publicación</button>
      </div>
    </form>
  </div>

  <footer style="padding-top: 20px;">
    <div id="footer" class="footer">
      <div class="row d-flex align-items-center" style="background-color:#0e0c0c">
        <div class="col-4">
          <div class="row d-flex align-items-center">
            <a class="col-3 text-white" href="#">Acerca de</a>
            <a class="col-3 text-white" href="#">Contacto</a>
            <a class="col-3 text-white" href="#">Politica de privacidad</a>
            <a class="col-3 text-white" href="#">Terminos y condiciones</a>
          </div>
        </div>
        <div class="col-4">
          <img src="./index/falg_footer.png" style="padding-top: 10px;">
          <div style="padding-right: 10px;">©2020 Arne, Inc.</div>
          <div style="padding-right: 10px;">All Rights Reserved</div>
        </div>
        <div class="col-4">
          <div class=row>
          </div>
        </div>
      </div>
    </div>
  </footer>

</body>
<style>
  .footer {
    left: 0;
    bottom: 0;
    width: 100%;
    background-color: rgb(48, 48, 48);
    color: white;
    text-align: center;
  }
</style>

</html>
<script>
  cuentas = [];
  publicaciones = [];
  $(document).ready(function () {
    $.get("http://localhost:3000/fpublicaciones", function (informacion) {
      publicaciones = informacion
    });
    $.get("http://localhost:3000/users", function (informacion) {
      cuentas = informacion;
    });
    $.get("http://localhost:3000/users/logueado", function (informacion) {
      var cuentaconectada = informacion.idconectado;
      if (cuentas.usuarios[cuentaconectada -1].conectado) {
        $("#ingresar").remove();
        $("#conectado").append(
          '<a class="nav-link" href="./perfil.html" style="color: white;">Perfil</a>'
        );
        $("#cerrarsesion").append(
          '<a class="btn btn-secundary" style="background-color: #666666;color: white;""'+
          'role="Cerrarsesion">Cerrar Sesión</a>'
        );
        $('#cerrarsesion').click(function () {
          $.ajax({
            url: "http://localhost:3000/users/login",
            type: "PUT",
            data: {
              usuarioid: cuentaconectada,
              conectado: false
            },
            success: function (result) {
              alert("Sesión cerrada con éxito!");
              location.href = "./index.html";
            },
          });
        });
      }
      $('#crearpublicacion').on('submit', function (event) {
        event.preventDefault();
        $.ajax({
          url: 'http://localhost:3000/fpublicaciones',
          type: 'POST',
          data: {
            titulo: $("#titulo").val(),
            descripcion: $("#descripcion").val(),
            usuario: cuentas.usuarios[cuentaconectada -1].nombre
          },
          success: function (result) {
            alert("Publicacion creada correctamente!");
            location.reload();
            location.href = "./foro.html";
          }
        });
      });
    });
  });
</script>